!function(){"use strict";const e={baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"4c60eaef-36e2-498d-8440-907e9f786db6","Content-Type":"application/json"}};class t{constructor(e,t,s,r,i){this.cardName=e.cardName,this.cardLink=e.cardLink,this.id=e._id,this.isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=r,this._handleLikeClick=i}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this.id,this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this.id,this)})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick(this)}))}handleLikeIcon(){this._likeButton.classList.toggle("card__like-button_enabled")}deleteCard(){this._cardElement.remove(),this._cardElement=null}getView(){return this._cardTemplate=document.querySelector(this._cardSelector).content.querySelector(".card"),this._cardElement=this._cardTemplate.cloneNode(!0),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this.isLiked&&this._likeButton.classList.add("card__like-button_enabled"),this._cardTitleEl.textContent=this.cardName,this._cardImageEl.setAttribute("src",this.cardLink),this._cardImageEl.setAttribute("alt",this.cardName),this._setEventListeners(),this._cardElement}}class s{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}disableButton(){return this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){return this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}toggleButtonState(){return this._hasInvalidInput()?this.disableButton():this._enableButton()}resetValidation(){this.disableButton(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=document.querySelector(`${t}-close`)}open(){this._popupElement.classList.add("modal_opened"),window.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("click",this._handleOverlayClick)}close(){this._popupElement.classList.remove("modal_opened"),window.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("click",this._handleOverlayClick)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleOverlayClick=e=>{e.target.classList.contains("modal_opened")&&this.close()};setEventListeners(){this._closeButton.addEventListener("click",(()=>this.close()))}}class i extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputSelector=".modal__input",this._inputList=[...this._popupForm.querySelectorAll(this._inputSelector)],this._submitButton=this._popupForm.querySelector(".modal__save-button"),this._handleFormSubmit=t}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._submitButton.textContent="Saving...",this._handleFormSubmit(this._getInputValues(),this._submitButton)})),super.setEventListeners()}}const n=document.querySelector(".profile__image"),o=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__image__edit-button"),l=document.querySelector(".profile__add-button"),d=document.forms["edit-profile-image-form"],u=document.forms["add-card-form"],c=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleRes=e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`);_request(e,t){return fetch(e,t).then(this._handleRes)}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{headers:this._headers})}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}setUserInfo=e=>{let{userName:t,userJob:s}=e;return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then((e=>e))};addNewCard=e=>{let{cardName:t,cardLink:s}=e;return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then((e=>e))};deleteCard=e=>this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers});likeCard=e=>this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers});removeLike=e=>this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers});editProfileImg=e=>this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}({baseUrl:e.baseUrl,headers:e.headers}),h=new class{constructor(e,t){let{userName:s,userJob:r,userImg:i}=e;this.userName=document.querySelector(s),this.userJob=document.querySelector(r),this.userImg=i,this._userImgEl=t}getUserInfo(){return this._userInfo={userName:this.userName.textContent,userJob:this.userJob.textContent,userImg:this.userImg},this._userInfo}setUserInfo(e){let{userName:t,userJob:s,userImg:r}=e;this.userName.textContent=t,this.userJob.textContent=s,this._userImgEl.src=r}}({userName:".profile__name",userJob:".profile__description"},n);c.getUserInfo().then((e=>{h.setUserInfo({userName:e.name,userJob:e.about,userImg:e.avatar})})).catch((e=>{console.error("Failed to receive user info",e)}));const _=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e,t){e.forEach((e=>this._renderer(e,t)))}addItem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";this._container[t](e)}}({renderer:(e,s)=>{e.link&&(e.cardLink=e.link),e.name&&(e.cardName=e.name);const r=function(e){return new t(e,"#card-template",L,k,m).getView()}(e);_.addItem(r,s)}},".cards__list");function m(e,t){t.isLiked?c.removeLike(e).then((e=>{t.handleLikeIcon(),t.isLiked=e.isLiked})).catch((e=>{console.error("Failed to remove like from card",e)})):c.likeCard(e).then((e=>{t.handleLikeIcon(),t.isLiked=e.isLiked})).catch((e=>{console.error("Failed to like card",e)}))}c.getInitialCards().then((e=>{_.renderItems(e,"append")})).catch((e=>{console.error("Failed to receive card data",e)}));const p=new class extends r{constructor(e){super({popupSelector:e}),this._popupImage=this._popupElement.querySelector(".modal__preview-image"),this._popupText=this._popupElement.querySelector(".modal__preview-text")}open(e){let{cardName:t,cardLink:s}=e;this._popupImage.setAttribute("src",s),this._popupImage.setAttribute("alt",t),this._popupText.textContent=t,super.open()}}("#preview-modal"),E=new i("#profile-modal",(function(e,t){c.setUserInfo(e).then((e=>{h.setUserInfo({userName:e.name,userJob:e.about,userImg:e.avatar}),E.close()})).catch((e=>{console.error("Failed to save changes in user info",e)})).finally((()=>{t.textContent="Save"}))})),v=new i("#edit-profile-image-modal",(function(e,t){c.editProfileImg(e.imageLink).then((e=>{e&&e.avatar&&h.setUserInfo({userName:e.name,userJob:e.about,userImg:e.avatar}),v.close(),d.reset(),I["edit-profile-image-form"].disableButton()})).catch((e=>{console.error("Failed to update profile image:",e)})).finally((()=>{t.textContent="Save"}))})),b=new i("#add-modal",(function(e,t){c.addNewCard(e).then((e=>{_.renderItems([e],"prepend"),b.close(),u.reset(),I["add-card-form"].disableButton()})).catch((e=>{console.error("Failed to add new card",e)})).finally((()=>{t.textContent="Create"}))})),f=new class extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this.handleFormSubmit=t}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this.handleFormSubmit(this.cardId,this.card)})),super.setEventListeners()}}("#delete-modal",(function(e,t){c.deleteCard(e).then((()=>{t.deleteCard(),f.close()})).catch((e=>{console.error("Failed to delete card",e)}))}));function L(e){p.open(e)}function k(e,t){f.open(),f.card=t,f.cardId=e}p.setEventListeners(),E.setEventListeners(),v.setEventListeners(),b.setEventListeners(),f.setEventListeners(),o.addEventListener("click",(()=>{I["profile-form"].resetValidation();const e=h.getUserInfo();E.setInputValues(e),E.open()})),a.addEventListener("click",(()=>{v.open()})),l.addEventListener("click",(()=>{b.open()}));const I={};var S;S={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},[...document.querySelectorAll(S.formSelector)].forEach((e=>{const t=new s(S,e),r=e.getAttribute("name");I[r]=t,t.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2QvSSxjQUFlLGdCQUNmRSxxQkFBc0Isc0JBQ3RCRSxvQkFBcUIsOEJBQ3JCRSxnQkFBaUIsMEJBQ2pCRSxXQUFZLHdCS2tOSyxJQUFJcEIsU0FBU3VCLGlCQUFpQm1JLEVBQU9DLGVBQzdDbkgsU0FBUzlCLElBQ2hCLE1BQU1rSixFQUFZLElBQUlwSixFQUFja0osRUFBUWhKLEdBQ3RDbUosRUFBV25KLEVBQVlvSixhQUFhLFFBQzFDUCxFQUFlTSxHQUFZRCxFQUMzQkEsRUFBVW5ILGtCQUFrQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAvLyBJbml0aWFsIGNhcmRzXHJcbi8vIGV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbi8vICAge1xyXG4vLyAgICAgY2FyZE5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbi8vICAgICBjYXJkTGluazpcclxuLy8gICAgICAgXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgY2FyZE5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuLy8gICAgIGNhcmRMaW5rOlxyXG4vLyAgICAgICBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBjYXJkTmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4vLyAgICAgY2FyZExpbms6XHJcbi8vICAgICAgIFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIGNhcmROYW1lOiBcIkxhdGVtYXJcIixcclxuLy8gICAgIGNhcmRMaW5rOlxyXG4vLyAgICAgICBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIGNhcmROYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4vLyAgICAgY2FyZExpbms6XHJcbi8vICAgICAgIFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgY2FyZE5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuLy8gICAgIGNhcmRMaW5rOlxyXG4vLyAgICAgICBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuLy8gICB9LFxyXG4vLyBdO1xyXG5cclxuLy92YWxpZGF0aW9uIHZhcmlhYmxlc1xyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc2F2ZS1idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG4vL0FwaSB2YXJpYWJsZXNcclxuZXhwb3J0IGNvbnN0IGFwaUNvbmZpZyA9IHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI0YzYwZWFlZi0zNmUyLTQ5OGQtODQ0MC05MDdlOWY3ODZkYjZcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5jYXJkTmFtZSA9IGRhdGEuY2FyZE5hbWU7XHJcbiAgICB0aGlzLmNhcmRMaW5rID0gZGF0YS5jYXJkTGluaztcclxuICAgIHRoaXMuaWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuaXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMuaWQsIHRoaXMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuaWQsIHRoaXMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlTGlrZUljb24oKSB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9lbmFibGVkXCIpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9jYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2VuYWJsZWRcIik7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLmNhcmROYW1lO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuY2FyZExpbmspO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuc2V0QXR0cmlidXRlKFwiYWx0XCIsIHRoaXMuY2FyZE5hbWUpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXHJcbiAgICBdO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHJldHVybiAodGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICByZXR1cm4gKHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlKTtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke3BvcHVwU2VsZWN0b3J9LWNsb3NlYCk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xpY2spO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbGljayk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZU92ZXJsYXlDbGljayA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IFwiLm1vZGFsX19pbnB1dFwiO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gW1xyXG4gICAgICAuLi50aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCksIHRoaXMuX3N1Ym1pdEJ1dHRvbik7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsIi8vIEltcG9ydCBmaWxlc1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyBhcGlDb25maWcsIGNvbmZpZywgaW5pdGlhbENhcmRzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qc1wiO1xyXG5cclxuLy9kZWZpbmUgZ2xvYmFsIHZhcmlhYmxlc1xyXG5jb25zdCBwcm9maWxlTW9kYWwgPSBcIiNwcm9maWxlLW1vZGFsXCI7XHJcbmNvbnN0IHByb2ZpbGVJbWdNb2RhbCA9IFwiI2VkaXQtcHJvZmlsZS1pbWFnZS1tb2RhbFwiO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IFwiLnByb2ZpbGVfX25hbWVcIjtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIjtcclxuY29uc3QgcHJvZmlsZUltYWdlID0gXCIucHJvZmlsZV9faW1hZ2VcIjtcclxuY29uc3QgcHJvZmlsZUltYWdlRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVJbWFnZSk7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRJbWFnZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9faW1hZ2VfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgYWRkTW9kYWwgPSBcIiNhZGQtbW9kYWxcIjtcclxuY29uc3QgZWRpdFByb2ZpbGVJbWdGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LXByb2ZpbGUtaW1hZ2UtZm9ybVwiXTtcclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImFkZC1jYXJkLWZvcm1cIl07XHJcbmNvbnN0IHByZXZpZXdNb2RhbCA9IFwiI3ByZXZpZXctbW9kYWxcIjtcclxuY29uc3QgZGVsZXRlTW9kYWwgPSBcIiNkZWxldGUtbW9kYWxcIjtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IGFwaUNvbmZpZy5iYXNlVXJsLFxyXG4gIGhlYWRlcnM6IGFwaUNvbmZpZy5oZWFkZXJzLFxyXG59KTtcclxuXHJcbi8vIENyZWF0ZSB1c2VyIGluZm8gaW5zdGFuY2VcclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oXHJcbiAge1xyXG4gICAgdXNlck5hbWU6IHByb2ZpbGVOYW1lLFxyXG4gICAgdXNlckpvYjogcHJvZmlsZURlc2NyaXB0aW9uLFxyXG4gIH0sXHJcbiAgcHJvZmlsZUltYWdlRWxcclxuKTtcclxuXHJcbi8vcmVjZWl2ZSB1c2VyIGluZm9cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIHVzZXJOYW1lOiByZXMubmFtZSxcclxuICAgICAgdXNlckpvYjogcmVzLmFib3V0LFxyXG4gICAgICB1c2VySW1nOiByZXMuYXZhdGFyLFxyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byByZWNlaXZlIHVzZXIgaW5mb1wiLCBlcnIpO1xyXG4gIH0pO1xyXG5cclxuLy9hZGQgY2FyZCBzZWN0aW9uIHRvIERPTSAmIGFkZCBpbml0aWFsIGNhcmRzXHJcblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIHJlbmRlcmVyOiAoY2FyZERhdGEsIG1ldGhvZCkgPT4ge1xyXG4gICAgICBpZiAoY2FyZERhdGEubGluaykge1xyXG4gICAgICAgIGNhcmREYXRhLmNhcmRMaW5rID0gY2FyZERhdGEubGluaztcclxuICAgICAgfVxyXG4gICAgICBpZiAoY2FyZERhdGEubmFtZSkge1xyXG4gICAgICAgIGNhcmREYXRhLmNhcmROYW1lID0gY2FyZERhdGEubmFtZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCwgbWV0aG9kKTtcclxuICAgIH0sXHJcbiAgfSxcclxuICBcIi5jYXJkc19fbGlzdFwiXHJcbik7XHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigoY2FyZHMpID0+IHtcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzLCBcImFwcGVuZFwiKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHJlY2VpdmUgY2FyZCBkYXRhXCIsIGVycik7XHJcbiAgfSk7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgICBpbWFnZUNsaWNrLFxyXG4gICAgZGVsZXRlQ2xpY2ssXHJcbiAgICBsaWtlQ2xpY2tcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcclxufVxyXG5cclxuLy9TdWJtaXQgaGFuZGxpbmcgZnVuY3Rpb25zXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChpbnB1dCwgYnV0dG9uKSB7XHJcbiAgYXBpXHJcbiAgICAuc2V0VXNlckluZm8oaW5wdXQpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgdXNlck5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICB1c2VySm9iOiBkYXRhLmFib3V0LFxyXG4gICAgICAgIHVzZXJJbWc6IGRhdGEuYXZhdGFyLFxyXG4gICAgICB9KTtcclxuICAgICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc2F2ZSBjaGFuZ2VzIGluIHVzZXIgaW5mb1wiLCBlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUltZ0Zvcm1TdWJtaXQoaW5wdXQsIGJ1dHRvbikge1xyXG4gIGFwaVxyXG4gICAgLmVkaXRQcm9maWxlSW1nKGlucHV0LmltYWdlTGluaylcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGlmIChkYXRhICYmIGRhdGEuYXZhdGFyKSB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICAgICAgdXNlck5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICAgIHVzZXJKb2I6IGRhdGEuYWJvdXQsXHJcbiAgICAgICAgICB1c2VySW1nOiBkYXRhLmF2YXRhcixcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBwcm9maWxlRWRpdEltYWdlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgZWRpdFByb2ZpbGVJbWdGb3JtLnJlc2V0KCk7XHJcbiAgICAgIGZvcm1WYWxpZGF0b3JzW1wiZWRpdC1wcm9maWxlLWltYWdlLWZvcm1cIl0uZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gdXBkYXRlIHByb2ZpbGUgaW1hZ2U6XCIsIGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBidXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdChpbnB1dCwgYnV0dG9uKSB7XHJcbiAgYXBpXHJcbiAgICAuYWRkTmV3Q2FyZChpbnB1dClcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKFtkYXRhXSwgXCJwcmVwZW5kXCIpO1xyXG4gICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgYWRkQ2FyZEZvcm0ucmVzZXQoKTtcclxuICAgICAgZm9ybVZhbGlkYXRvcnNbXCJhZGQtY2FyZC1mb3JtXCJdLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGFkZCBuZXcgY2FyZFwiLCBlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gXCJDcmVhdGVcIjtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkRm9ybVN1Ym1pdChjYXJkSWQsIGNhcmQpIHtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZGVsZXRlIGNhcmRcIiwgZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBsaWtlQ2xpY2soY2FyZElkLCBjYXJkKSB7XHJcbiAgaWYgKCFjYXJkLmlzTGlrZWQpIHtcclxuICAgIGFwaVxyXG4gICAgICAubGlrZUNhcmQoY2FyZElkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xyXG4gICAgICAgIGNhcmQuaXNMaWtlZCA9IHJlcy5pc0xpa2VkO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbGlrZSBjYXJkXCIsIGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGlcclxuICAgICAgLnJlbW92ZUxpa2UoY2FyZElkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xyXG4gICAgICAgIGNhcmQuaXNMaWtlZCA9IHJlcy5pc0xpa2VkO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gcmVtb3ZlIGxpa2UgZnJvbSBjYXJkXCIsIGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuLy8gY3JlYXRlIGluc3RhbmNlcyBmb3IgbW9kYWxzIC0gcHJldmlldywgcHJvZmlsZS1lZGl0LCBlZGl0LXByb2ZpbGUtaW1hZ2UsIGFkZC1jYXJkLCBkZWxldGUtY2FyZCxcclxuY29uc3QgcHJldmlld1BvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHByZXZpZXdNb2RhbCk7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgcHJvZmlsZU1vZGFsLFxyXG4gIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBwcm9maWxlSW1nTW9kYWwsXHJcbiAgaGFuZGxlUHJvZmlsZUltZ0Zvcm1TdWJtaXRcclxuKTtcclxuXHJcbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKGFkZE1vZGFsLCBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdCk7XHJcbi8vIGNhbGwgc2V0RXZlbnRsaXN0ZW5lcnMgZm9yIGVhY2ggcG9wdXBcclxuXHJcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtKFxyXG4gIGRlbGV0ZU1vZGFsLFxyXG4gIGhhbmRsZURlbGV0ZUNhcmRGb3JtU3VibWl0XHJcbik7XHJcblxyXG5wcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucHJvZmlsZUVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wcm9maWxlRWRpdEltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9oYW5kbGUgbW9kYWwgdHJpZ2dlcnNcclxuZnVuY3Rpb24gaW1hZ2VDbGljayhkYXRhKSB7XHJcbiAgcHJldmlld1BvcHVwLm9wZW4oZGF0YSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZUNsaWNrKGNhcmRJZCwgY2FyZCkge1xyXG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLmNhcmQgPSBjYXJkO1xyXG4gIGRlbGV0ZUNhcmRQb3B1cC5jYXJkSWQgPSBjYXJkSWQ7XHJcbn1cclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgY29uc3QgaW5wdXQgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVFZGl0UG9wdXAuc2V0SW5wdXRWYWx1ZXMoaW5wdXQpO1xyXG4gIHByb2ZpbGVFZGl0UG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVFZGl0SW1hZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwcm9maWxlRWRpdEltYWdlUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbi8vIFZhbGlkYXRpb25cclxuXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKV07XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9oYW5kbGVSZXMgPSAocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH07XHJcblxyXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9oYW5kbGVSZXMpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvID0gKHsgdXNlck5hbWUsIHVzZXJKb2IgfSkgPT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdXNlck5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IHVzZXJKb2IsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICByZXR1cm4gZGF0YTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIGFkZE5ld0NhcmQgPSAoeyBjYXJkTmFtZSwgY2FyZExpbmsgfSkgPT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBjYXJkTmFtZSxcclxuICAgICAgICBsaW5rOiBjYXJkTGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgZGVsZXRlQ2FyZCA9IChjYXJkSWQpID0+IHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgbGlrZUNhcmQgPSAoY2FyZElkKSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIHJlbW92ZUxpa2UgPSAoY2FyZElkKSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIGVkaXRQcm9maWxlSW1nID0gKGlucHV0KSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBpbnB1dCxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9O1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IHVzZXJOYW1lLCB1c2VySm9iLCB1c2VySW1nIH0sIHVzZXJJbWdFbCkge1xyXG4gICAgdGhpcy51c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWUpO1xyXG4gICAgdGhpcy51c2VySm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VySm9iKTtcclxuICAgIHRoaXMudXNlckltZyA9IHVzZXJJbWc7XHJcbiAgICB0aGlzLl91c2VySW1nRWwgPSB1c2VySW1nRWw7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgdGhpcy5fdXNlckluZm8gPSB7XHJcbiAgICAgIHVzZXJOYW1lOiB0aGlzLnVzZXJOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICB1c2VySm9iOiB0aGlzLnVzZXJKb2IudGV4dENvbnRlbnQsXHJcbiAgICAgIHVzZXJJbWc6IHRoaXMudXNlckltZyxcclxuICAgIH07XHJcbiAgICByZXR1cm4gdGhpcy5fdXNlckluZm87XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IHVzZXJOYW1lLCB1c2VySm9iLCB1c2VySW1nIH0pIHtcclxuICAgIHRoaXMudXNlck5hbWUudGV4dENvbnRlbnQgPSB1c2VyTmFtZTtcclxuICAgIHRoaXMudXNlckpvYi50ZXh0Q29udGVudCA9IHVzZXJKb2I7XHJcbiAgICB0aGlzLl91c2VySW1nRWwuc3JjID0gdXNlckltZztcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMsIG1ldGhvZCkge1xyXG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSwgbWV0aG9kKSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQsIG1ldGhvZCA9IFwicHJlcGVuZFwiKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXJbbWV0aG9kXShlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3BvcHVwVGV4dCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LXRleHRcIik7XHJcbiAgfVxyXG4gIG9wZW4oeyBjYXJkTmFtZSwgY2FyZExpbmsgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgY2FyZExpbmspO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgY2FyZE5hbWUpO1xyXG4gICAgdGhpcy5fcG9wdXBUZXh0LnRleHRDb250ZW50ID0gY2FyZE5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5oYW5kbGVGb3JtU3VibWl0KHRoaXMuY2FyZElkLCB0aGlzLmNhcmQpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiYXBpQ29uZmlnIiwiYmFzZVVybCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwiaWQiLCJfaWQiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVCdXR0b24iLCJfY2FyZEltYWdlRWwiLCJoYW5kbGVMaWtlSWNvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImRlbGV0ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJnZXRWaWV3IiwiX2NhcmRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZFRpdGxlRWwiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInNldEF0dHJpYnV0ZSIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiX2hpZGVJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsInJlc2V0VmFsaWRhdGlvbiIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJQb3B1cCIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJ3aW5kb3ciLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlT3ZlcmxheUNsaWNrIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwidGFyZ2V0IiwiY29udGFpbnMiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZm9ybVZhbHVlcyIsImlucHV0IiwibmFtZSIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJwcm9maWxlSW1hZ2VFbCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRJbWFnZUJ1dHRvbiIsImFkZENhcmRCdXR0b24iLCJlZGl0UHJvZmlsZUltZ0Zvcm0iLCJmb3JtcyIsImFkZENhcmRGb3JtIiwiYXBpIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9oYW5kbGVSZXMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwidXNlck5hbWUiLCJ1c2VySm9iIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImFkZE5ld0NhcmQiLCJfcmVmMyIsImxpbmsiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInJlbW92ZUxpa2UiLCJlZGl0UHJvZmlsZUltZyIsImF2YXRhciIsInVzZXJJbmZvIiwidXNlckltZ0VsIiwidXNlckltZyIsIl91c2VySW1nRWwiLCJfdXNlckluZm8iLCJzcmMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImNhcmRTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiY2FyZERhdGEiLCJjYXJkRWxlbWVudCIsImltYWdlQ2xpY2siLCJkZWxldGVDbGljayIsImxpa2VDbGljayIsImNyZWF0ZUNhcmQiLCJjYXJkIiwiY2FyZHMiLCJwcmV2aWV3UG9wdXAiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRleHQiLCJwcm9maWxlRWRpdFBvcHVwIiwiYnV0dG9uIiwiZmluYWxseSIsInByb2ZpbGVFZGl0SW1hZ2VQb3B1cCIsImltYWdlTGluayIsInJlc2V0IiwiZm9ybVZhbGlkYXRvcnMiLCJhZGRDYXJkUG9wdXAiLCJkZWxldGVDYXJkUG9wdXAiLCJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=